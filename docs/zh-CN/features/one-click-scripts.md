# 一键运行脚本

将您的 npm 脚本转变为可点击的按钮，并实时显示终端输出。

## 概览

您 `package.json` 中的每个脚本都会成为 PackageFlow 中可点击的卡片。不再需要输入命令 — 只需点击并观看。

<!-- TODO: Add screenshot of script cards -->

## 运行脚本

### 基本运行

1. 从侧边栏选择一个项目
2. 找到脚本卡片（例如 `dev`、`build`、`test`）
3. 点击卡片运行

终端面板会自动打开，显示实时输出。

<!-- TODO: Add gif of clicking a script and seeing output -->

### 脚本状态

| 状态 | 指示器 | 说明 |
|------|--------|------|
| 就绪 | 默认 | 脚本准备好运行 |
| 运行中 | 转圈 | 脚本正在运行 |
| 成功 | 绿色勾选 | 脚本成功完成 |
| 失败 | 红色 X | 脚本以错误结束 |

## 终端功能

### PTY（伪终端）

PackageFlow 使用 PTY 实现真正的终端模拟：

- **颜色**：完整 ANSI 颜色支持
- **交互**：支持交互式提示
- **光标**：正确的光标移动
- **Unicode**：完整 unicode 支持

### 输出缓冲区

- 最大缓冲区大小：1MB
- 较旧的输出会自动修剪
- 使用清除按钮清除终端

<!-- TODO: Add screenshot of terminal with colorful output -->

## 停止脚本

### 单个脚本

点击运行中脚本卡片上的**停止**按钮，或点击终端面板中的停止图标。

### 所有脚本

使用状态栏中的**全部停止**按钮来终止所有运行中的脚本。

## 端口管理

PackageFlow 自动检测脚本使用的端口。

### 端口冲突检测

如果脚本尝试使用已被占用的端口：

1. PackageFlow 检测到冲突
2. 显示哪个进程正在使用该端口
3. 提供终止冲突进程的选项

<!-- TODO: Add screenshot of port conflict dialog -->

### 检查端口

在运行开发服务器前，您可以：

1. 右键点击项目
2. 选择**检查端口**
3. 查看当前正在使用的端口

### 终止端口

释放特定端口：

1. 右键点击项目
2. 选择**终止端口**
3. 输入要终止的端口号
4. 确认操作

## 脚本分类

脚本会按照常见模式自动组织：

| 类别 | 脚本 |
|------|------|
| 开发 | `dev`、`start`、`serve` |
| 构建 | `build`、`compile` |
| 测试 | `test`、`test:*`、`jest`、`vitest` |
| 代码检查 | `lint`、`eslint`、`prettier` |
| 其他 | 其他所有脚本 |

<!-- TODO: Add screenshot showing script categories -->

## 环境变量

脚本使用您系统的环境变量运行。要自定义：

1. 在项目根目录创建 `.env` 文件
2. PackageFlow 会自动加载这些变量

## 运行多个脚本

您可以同时运行多个脚本：

1. 点击第一个脚本启动它
2. 在其他脚本运行时点击额外的脚本
3. 每个脚本都有自己的终端标签

<!-- TODO: Add screenshot of multiple terminal tabs -->

## 提示

1. **使用键盘快捷键**：学习常用脚本的快捷键
2. **注意状态栏**：它显示运行中脚本的数量
3. **检查端口冲突**：启动开发服务器前运行「检查端口」
4. **定期清除终端**：保持输出干净以便于调试
