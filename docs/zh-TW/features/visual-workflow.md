# 視覺化工作流程

使用拖放式編輯器建立自動化流程。串聯腳本、觸發其他工作流程，並自動化您的開發流程。

## 概覽

視覺化工作流程讓您無需撰寫腳本即可建立多步驟自動化。適用於：

- 建置和部署管線
- 測試序列
- 發布流程
- 日常開發例行工作

<!-- TODO: Add screenshot of workflow editor -->

## 建立工作流程

### 新增工作流程

1. 導覽至**工作流程**分頁
2. 點擊**新增工作流程**
3. 為您的工作流程命名
4. 開始新增節點

### 畫布

工作流程編輯器是一個視覺化畫布，您可以：

- **拖曳**側邊欄的節點
- **連接**節點與邊緣
- **設定**每個節點的設定

<!-- TODO: Add gif of dragging and connecting nodes -->

## 節點類型

### 腳本節點

執行 shell 指令或 npm 腳本。

**設定：**
- **指令**：要執行的指令
- **工作目錄**：執行指令的位置（選用）
- **逾時**：最大執行時間（選用）

<!-- TODO: Add screenshot of script node configuration -->

### 觸發工作流程節點

觸發另一個工作流程，實現巢狀自動化。

**設定：**
- **工作流程**：選擇要觸發的工作流程
- **等待完成**：是否等待後再繼續

> 注意：PackageFlow 會偵測循環參照並防止無限迴圈。

## 連接節點

### 建立連接

1. 從節點的**輸出端點**（右側）點擊並拖曳
2. 放到另一個節點的**輸入端點**（左側）
3. 連接建立完成

### 平行執行

將多個節點連接到同一個輸出以平行執行：

```
        ┌─→ [單元測試]
[建置]──┼─→ [E2E 測試]
        └─→ [整合測試]
```

### 循序執行

將節點串聯以循序執行：

```
[建置] → [測試] → [部署]
```

<!-- TODO: Add screenshot showing parallel vs sequential execution -->

## 失敗策略

設定節點失敗時的處理方式：

### 失敗時停止（預設）

任何節點失敗時，工作流程立即停止。

### 失敗時繼續

即使一個節點失敗，工作流程仍繼續執行剩餘節點。

<!-- TODO: Add screenshot of failure strategy selector -->

## 執行工作流程

### 手動觸發

1. 從列表選擇工作流程
2. 點擊**執行工作流程**
3. 即時觀看執行過程

### 執行視覺化

執行期間：
- **執行中節點**：動畫邊框
- **已完成節點**：綠色勾選
- **失敗節點**：紅色 X 與錯誤詳情

<!-- TODO: Add gif of workflow execution with node states -->

## 執行歷史

檢視過去的工作流程執行：

1. 選擇工作流程
2. 點擊面板中的**歷史**
3. 查看所有過去的執行，包含：
   - 時間戳記
   - 持續時間
   - 狀態（成功/失敗）
   - 每個節點的日誌

<!-- TODO: Add screenshot of execution history panel -->

## 工作流程範本

### 儲存為範本

將常用的工作流程儲存為範本：

1. 建立並設定您的工作流程
2. 點擊**儲存為範本**
3. 給它一個名稱和描述
4. 範本現在可供日後使用

### 使用範本

1. 點擊**新增工作流程**
2. 選擇**從範本**
3. 選擇範本
4. 根據需要自訂

<!-- TODO: Add screenshot of template selection dialog -->

## 環境變數

為工作流程中的所有節點設定環境變數：

1. 開啟工作流程設定
2. 新增鍵值對
3. 變數可用於所有腳本節點

## 提示

1. **從簡單開始**：從 2-3 個節點開始，需要時再擴展
2. **使用範本**：將常見模式儲存為範本
3. **檢查歷史**：檢視過去的執行以除錯失敗
4. **清楚命名節點**：使用描述性名稱以便於除錯
5. **逐步測試**：每新增一個節點後執行工作流程

## 範例

### 建置和部署

```
[安裝依賴] → [建置] → [執行測試] → [部署到 Staging]
```

### 日常開發

```
[拉取最新] → [安裝] → [啟動開發伺服器]
```

### 發布管線

```
[執行測試] → [建置] → [版本號遞增] → [建立標籤] → [部署]
```
